

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="keywords" content="Vitis, library, Database, Quantitative Finance, Vision, Data Compression, Security, Solver, BLAS, Hardware, xfOpenCV, xfdatabase, xffintech, xfcompression, xfsecurity, xfsolver, xfblas, xfhardware"/>
<meta name="description" content="Vitis software development platform includes an extensive set of open-source, performance-optimized libraries that offer out-of-the-box acceleration with minimal to zero-code changes to your existing applications, without the need to reimplement your algorithms from scratch to harness the benefits of Xilinx adaptive compute."/>
<meta name="xlnxdocumentclass" content="Document"> 
<meta name="xlnxdocumenttypes" content="Tutorials"> 
<!-- Header information provided by Emily-->
    <meta name="Language" content="en">
    <meta name="Location" content="us">
    <link rel="icon" type="image/vnd.microsoft.icon" href="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/all/resources/favicon.ico">
    <link rel="shortcut icon" type="image/vnd.microsoft.icon" href="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/all/resources/favicon.ico">
  
  <title>L3 API example &mdash; Vitis BLAS Library 1.0 beta documentation</title>
  
<!-- Header information provided by Emily-->
    <meta name="apple-itunes-app" content="app-id=1063287962">
    <meta name="google-play-app" content="app-id=com.marketing.xilinxgo">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <script src="https://kit.fontawesome.com/d3dd8c60ed.js"></script>
    
    <link rel="stylesheet" href="https://www.xilinx.com/etc.clientlibs/clientlibs/granite/jquery-ui.min.css" type="text/css">
    <link rel="stylesheet" href="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/header-footer.min.css" type="text/css">
    <link rel="stylesheet" href="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/all.min.css" type="text/css">
    
    <script type="text/javascript" src="https://www.xilinx.com/etc.clientlibs/clientlibs/granite/jquery.min.js"></script>
    <script type="text/javascript" src="https://www.xilinx.com/etc.clientlibs/clientlibs/granite/jquery-ui.min.js"></script>
    <script type="text/javascript" src="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/header-footer.min.js"></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500" rel="stylesheet" type="text/css">
  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="L3 API GEMM example" href="L3_example_gemm.html" />
    <link rel="prev" title="1. Introduction" href="L3_overview_content.html" /> 
</head>

<body class="wy-body-for-nav">
<div class="xilinx-bs3">
    <noindex>
        <header data-component="header">
            <nav class="navbar navbar-default">
                <div class="container main-nav">
                    <div class="row">
                        <div class="col-xs-5 col-sm-2 logo-column">
                            <div class="logo">
                                <a href="https://www.xilinx.com/">
                                    <img src="https://www.xilinx.com/etc.clientlibs/site/clientlibs/xilinx/all/resources/imgs/header/xilinx-header-logo.svg" title="Xilinx Inc" />
                                </a>
                            </div>
                        </div>
                        <div class="col-xs-12 col-sm-8 navbar-column">
                            <div class="navbar navbar-collapse collapse" id="xilinx-main-menu">
                                <ul class="nav navbar-nav nav-justified">
                                    <li class="accordion-toggle-icons" data-component="toggle-dropdown">
                                        <a href="https://developer.xilinx.com/">
                                            Developers
                                        </a>
                                    </li>
                                    <li class="accordion-toggle-icons" data-component="toggle-dropdown">
                                        <a href="https://www.xilinx.com/support.html">
                                            Support
                                        </a>
                                    </li>
                                    <li class="accordion-toggle-icons" data-component="toggle-dropdown">
                                        <a href="https://forums.xilinx.com/">
                                            Forums
                                        </a>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="mini-nav col-sm-2">
                            <button type="button" data-function="xilinx-mobile-menu" id="nav-toggle" class="navbar-toggle collapsed visible-xs-block" aria-expanded="false">
                                <span></span>
                                <span></span>
                                <span></span>
                                <span></span>
                            </button>
                        </div>
                    </div>
                </div>
            </nav>
        </header>
    </noindex>
</div>
   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home" alt="Documentation Home"> Vitis BLAS Library
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Library Overview</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html#license">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../overview.html#trademark-notice">Trademark Notice</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../release.html">Release Note</a></li>
</ul>
<p class="caption"><span class="caption-text">User Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../L1/L1.html">L1 Primitives User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="L3.html">L3 API User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="L3_overview.html">L3 API Overview</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">L3 API example</a><ul>
<li class="toctree-l3"><a class="reference internal" href="L3_example_gemm.html">L3 API GEMM example</a></li>
<li class="toctree-l3"><a class="reference internal" href="L3_example_gemv.html">L3 API GEMV example</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="L3_benchmark.html">L3 API benchmark</a></li>
<li class="toctree-l2"><a class="reference internal" href="L3_test.html">L3 API test</a></li>
<li class="toctree-l2"><a class="reference internal" href="L3_python_bindings.html">L3 Python bindings</a></li>
<li class="toctree-l2"><a class="reference internal" href="L3_application.html">L3 API application</a></li>
</ul>
</li>
</ul>

            
			<p class="caption"><span class="caption-text">This Page</span></p>
				<ul class="current">
				  <li class="toctree-l1"><a href="../../_sources/user_guide/L3/L3_example.rst.txt"
						rel="nofollow">Show Source</a></li>						
				</ul>
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Vitis BLAS Library</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="L3.html">L3 API User Guide</a> &raquo;</li>
        
      <li>L3 API example</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/user_guide/L3/L3_example.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="l3-api-example">
<span id="example-l3"></span><h1>L3 API example<a class="headerlink" href="#l3-api-example" title="Permalink to this headline">Â¶</a></h1>
<p>For example code references please follow the link below.</p>
<p><strong>1. XFBLAS L3 compilation</strong></p>
<p>All examples provided here could be built with compilation steps similar to the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>g++ -O0 -std<span class="o">=</span>c++11 -fPIC -Wextra -Wall -Wno-ignored-attributes -Wno-unused-parameter -Wno-unused-variable -I<span class="k">$(</span>XILINX_XRT<span class="k">)</span>/include -I/include/sw -o example.exe example.cpp -L<span class="k">$(</span>XILINX_XRT<span class="k">)</span>/lib -lz -lstdc++ -lrt -pthread -lxrt_core -ldl -luuid
</pre></div>
</div>
<p><strong>2. XFBLAS L3 run</strong></p>
<p>Most of the examples could be run with steps similar to the following in machine with HW device installed. Detailed usages are also provided in each section.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./example.exe PATH_TO_XCLBIN/example.xclbin PATH_TO_XCLBIN/config_info.dat
</pre></div>
</div>
<p><strong>3. XFBLAS L3 code example</strong></p>
<p>The following is an example of how to use XFBLAS API. Users always need to include header file xf_blas.hpp.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;xf_blas.hpp&quot;</span><span class="cp"></span>

<span class="cp"># define IDX2R(i,j,ld) (((i)*( ld ))+(j))</span>
<span class="cp"># define m 128 </span><span class="c1">// a - mxk matrix</span>
<span class="cp"># define n 128 </span><span class="c1">// b - kxn matrix</span>
<span class="cp"># define k 128 </span><span class="c1">// c - mxn matrix</span>

<span class="k">using</span> <span class="k">namespace</span> <span class="n">std</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span> <span class="p">{</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">){</span>
    <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; usage: </span><span class="se">\n</span><span class="s">&quot;</span>
         <span class="o">&lt;&lt;</span> <span class="s">&quot; gemx_example.exe gemx.xclbin config_info.dat log.txt</span><span class="se">\n</span><span class="s">&quot;</span>
         <span class="o">&lt;&lt;</span> <span class="s">&quot; gemx_example.exe gemx.xclbin config_info.dat</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
    <span class="k">return</span> <span class="n">EXIT_FAILURE</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="kt">unsigned</span> <span class="kt">int</span> <span class="n">l_argIdx</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="n">string</span> <span class="n">l_xclbinFile</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="n">l_argIdx</span><span class="o">++</span><span class="p">]);</span>
  <span class="n">string</span> <span class="n">l_configFile</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="n">l_argIdx</span><span class="o">++</span><span class="p">]);</span>
  <span class="n">string</span> <span class="n">l_logFile</span><span class="p">;</span>

  <span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">==</span> <span class="mi">3</span><span class="p">){</span>
    <span class="n">ofstream</span> <span class="n">logFile</span><span class="p">(</span><span class="s">&quot;log.txt&quot;</span><span class="p">);</span>
    <span class="n">logFile</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>
    <span class="n">l_logFile</span> <span class="o">=</span> <span class="s">&quot;log.txt&quot;</span><span class="p">;</span>
  <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
    <span class="n">l_logFile</span> <span class="o">=</span> <span class="n">argv</span><span class="p">[</span><span class="n">l_argIdx</span><span class="o">++</span><span class="p">];</span>
  <span class="p">}</span>

  <span class="kt">int</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">;</span> <span class="c1">// i-row index ,j- column index</span>
  <span class="kt">short</span> <span class="o">*</span> <span class="n">a</span><span class="p">,</span> <span class="o">*</span> <span class="n">b</span><span class="p">,</span> <span class="o">*</span> <span class="n">c</span><span class="p">;</span>
  <span class="n">a</span> <span class="o">=</span> <span class="p">(</span> <span class="kt">short</span> <span class="o">*</span><span class="p">)</span> <span class="n">malloc</span> <span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">k</span><span class="o">*</span> <span class="k">sizeof</span> <span class="p">(</span> <span class="kt">short</span> <span class="p">));</span>
  <span class="n">b</span> <span class="o">=</span> <span class="p">(</span> <span class="kt">short</span> <span class="o">*</span><span class="p">)</span> <span class="n">malloc</span> <span class="p">(</span><span class="n">k</span><span class="o">*</span><span class="n">n</span><span class="o">*</span> <span class="k">sizeof</span> <span class="p">(</span> <span class="kt">short</span> <span class="p">));</span>
  <span class="n">c</span> <span class="o">=</span> <span class="p">(</span> <span class="kt">short</span> <span class="o">*</span><span class="p">)</span> <span class="n">malloc</span> <span class="p">(</span><span class="n">m</span><span class="o">*</span><span class="n">n</span><span class="o">*</span> <span class="k">sizeof</span> <span class="p">(</span> <span class="kt">short</span> <span class="p">));</span>

  <span class="kt">int</span> <span class="n">ind</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span>  <span class="n">m</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span><span class="p">){</span>
    <span class="k">for</span><span class="p">(</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">k</span><span class="p">;</span> <span class="n">j</span> <span class="o">++</span><span class="p">){</span>
      <span class="n">a</span><span class="p">[</span> <span class="n">IDX2R</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span> <span class="p">)]</span><span class="o">=</span> <span class="p">(</span><span class="kt">short</span><span class="p">)</span> <span class="n">ind</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>
  <span class="n">ind</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
  <span class="k">for</span><span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span>  <span class="n">k</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span><span class="p">){</span>
    <span class="k">for</span><span class="p">(</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span> <span class="o">++</span><span class="p">){</span>
      <span class="n">b</span><span class="p">[</span> <span class="n">IDX2R</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">n</span> <span class="p">)]</span><span class="o">=</span> <span class="p">(</span><span class="kt">short</span><span class="p">)</span> <span class="n">ind</span><span class="o">++</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="k">for</span><span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span>  <span class="n">m</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span><span class="p">){</span>
    <span class="k">for</span><span class="p">(</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="n">n</span><span class="p">;</span> <span class="n">j</span> <span class="o">++</span><span class="p">){</span>
      <span class="n">c</span><span class="p">[</span> <span class="n">IDX2R</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">n</span> <span class="p">)]</span><span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="n">xfblasEngine_t</span> <span class="n">engineName</span> <span class="o">=</span> <span class="n">XFBLAS_ENGINE_GEMM</span><span class="p">;</span>
  <span class="n">xfblasStatus_t</span> <span class="n">status</span> <span class="o">=</span> <span class="n">xfblasCreate</span><span class="p">(</span><span class="n">l_xclbinFile</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span> <span class="n">l_configFile</span><span class="p">,</span> <span class="n">l_logFile</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span> <span class="n">engineName</span><span class="p">);</span>
  <span class="n">status</span> <span class="o">=</span> <span class="n">xfblasMallocRestricted</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">),</span><span class="n">a</span><span class="p">,</span><span class="n">k</span><span class="p">);</span>
  <span class="n">status</span> <span class="o">=</span> <span class="n">xfblasMallocRestricted</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">b</span><span class="p">),</span><span class="n">b</span><span class="p">,</span><span class="n">n</span><span class="p">);</span>
  <span class="n">status</span> <span class="o">=</span> <span class="n">xfblasMallocRestricted</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">c</span><span class="p">),</span><span class="n">c</span><span class="p">,</span><span class="n">n</span><span class="p">);</span>
  <span class="n">status</span> <span class="o">=</span> <span class="n">xfblasSetMatrixRestricted</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
  <span class="n">status</span> <span class="o">=</span> <span class="n">xfblasSetMatrixRestricted</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
  <span class="n">status</span> <span class="o">=</span> <span class="n">xfblasSetMatrixRestricted</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
  <span class="n">status</span> <span class="o">=</span> <span class="n">xfblasGemm</span><span class="p">(</span><span class="n">XFBLAS_OP_N</span><span class="p">,</span> <span class="n">XFBLAS_OP_N</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">n</span><span class="p">);</span>
  <span class="n">status</span> <span class="o">=</span> <span class="n">xfblasGetMatrixRestricted</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>

  <span class="k">for</span> <span class="p">(</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">128</span><span class="p">;</span> <span class="n">i</span> <span class="o">++</span><span class="p">){</span>
    <span class="k">for</span> <span class="p">(</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">128</span><span class="p">;</span> <span class="n">j</span> <span class="o">++</span><span class="p">){</span>
      <span class="n">cout</span><span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">c</span><span class="p">[</span> <span class="n">IDX2R</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span> <span class="p">)])</span><span class="o">&lt;&lt;</span><span class="s">&quot; &quot;</span><span class="p">;</span>
    <span class="p">}</span>
    <span class="n">cout</span><span class="o">&lt;&lt;</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
  <span class="p">}</span>


  <span class="n">xfblasFree</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
  <span class="n">xfblasFree</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
  <span class="n">xfblasFree</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>
  <span class="n">xfblasDestroy</span><span class="p">();</span>
  <span class="n">free</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
  <span class="n">free</span><span class="p">(</span><span class="n">b</span><span class="p">);</span>
  <span class="n">free</span><span class="p">(</span><span class="n">c</span><span class="p">);</span>

  <span class="k">return</span> <span class="n">EXIT_SUCCESS</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>These API functions run on the first kernel by default, but they could support multi-kernels xclbin. Users will need to put numbers of kernels or index of the kernel in those functions to let the API know. The following code shows how to initialize XFBLAS library to support a xclbin with 2 kernels and run with the second kernel.</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">xfblasStatus_t</span> <span class="n">status</span> <span class="o">=</span> <span class="n">xfblasCreate</span><span class="p">(</span><span class="n">l_xclbinFile</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span> <span class="n">l_configFile</span><span class="p">,</span> <span class="n">l_logFile</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span> <span class="n">XFBLAS_ENGINE_GEMM</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="n">status</span> <span class="o">=</span> <span class="n">xfblasMallocRestricted</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">a</span><span class="p">),</span><span class="n">a</span><span class="p">,</span><span class="n">k</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">status</span> <span class="o">=</span> <span class="n">xfblasMallocRestricted</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">b</span><span class="p">),</span><span class="n">b</span><span class="p">,</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">status</span> <span class="o">=</span> <span class="n">xfblasMallocRestricted</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="k">sizeof</span><span class="p">(</span><span class="o">*</span><span class="n">c</span><span class="p">),</span><span class="n">c</span><span class="p">,</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">status</span> <span class="o">=</span> <span class="n">xfblasSetMatrixRestricted</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">status</span> <span class="o">=</span> <span class="n">xfblasSetMatrixRestricted</span><span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">status</span> <span class="o">=</span> <span class="n">xfblasSetMatrixRestricted</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">status</span> <span class="o">=</span> <span class="n">xfblasGemm</span><span class="p">(</span><span class="n">XFBLAS_OP_N</span><span class="p">,</span> <span class="n">XFBLAS_OP_N</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">status</span> <span class="o">=</span> <span class="n">xfblasGetMatrixRestricted</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
<p><strong>4. XFBLAS L3 example</strong></p>
<p>Please see L3 example folder for more example cases.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="L3_example_gemm.html">L3 API GEMM example</a><ul>
<li class="toctree-l2"><a class="reference internal" href="L3_example_gemm.html#xfblasgemm-matrix-matrix-multiplication">1. xfblasGemm - matrix-matrix multiplication</a></li>
<li class="toctree-l2"><a class="reference internal" href="L3_example_gemm.html#xfblasgemm-restricted-memory-version">2. xfblasGemm - restricted memory version</a></li>
<li class="toctree-l2"><a class="reference internal" href="L3_example_gemm.html#xfblasgemm-pre-allocated-memory-version">3. xfblasGemm - pre-allocated memory version</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="L3_example_gemv.html">L3 API GEMV example</a><ul>
<li class="toctree-l2"><a class="reference internal" href="L3_example_gemv.html#xfblasgemv-matrix-vector-multiplication">1. xfblasGemv - matrix-vector multiplication</a></li>
<li class="toctree-l2"><a class="reference internal" href="L3_example_gemv.html#xfblasgemv-restricted-memory-version">2. xfblasGemv - restricted memory version</a></li>
</ul>
</li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="L3_example_gemm.html" class="btn btn-neutral float-right" title="L3 API GEMM example" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="L3_overview_content.html" class="btn btn-neutral float-left" title="1. Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo" class="copyright">
    <p>
        
        &copy; Copyright 2019, Xilinx Inc.

    </p>
  </div>
<!--
    
    
      Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 
-->
</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>